<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Connect to/authenticate with a neuPrint server and its Neo4j database, returning a neuPrint connection object — neuprint_connection • neuprintr</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Connect to/authenticate with a neuPrint server and its Neo4j database, returning a neuPrint connection object — neuprint_connection"><meta property="og:description" content='neuprint_login allows you to login to a neuPrint server
  specified by a neuprint_connection object. If such an object is not
  specified, then the last successful connection in this R session is reused
  if possible otherwise a new connection object is created using
  environment variables of the form "neuprint_*" (see details).
If your server has more than one dataset available, it is also a good idea
  to set the default neuPrint dataset you want to work with, either by
  passing an explicit dataset argument (to neuprint_login or
  neuprint_connection) when first making the connection or by setting
  a neuprint_dataset environment variable.
The connection object returned by neuprint_login (or cached when
  Cache=TRUE, the default) can then be used for future requests to the
  neuPrint server by get/query/fetch functions.'><meta property="og:image" content="https://natverse.org/neuprintr/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">neuprintr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/customquery.html">Writing query functions in neuprintr</a>
    </li>
    <li>
      <a href="../articles/hemibrain_opns.html">hemibrain olfactory projection neurons</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/natverse/neuprintr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Connect to/authenticate with a neuPrint server and its Neo4j database, returning a neuPrint connection object</h1>
    <small class="dont-index">Source: <a href="https://github.com/natverse/neuprintr/blob/master/R/conn.R" class="external-link"><code>R/conn.R</code></a></small>
    <div class="hidden name"><code>neuprint_login.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>neuprint_login</code> allows you to login to a neuPrint server
  specified by a <code>neuprint_connection</code> object. If such an object is not
  specified, then the last successful connection in this R session is reused
  if possible otherwise a new connection object is created using
  <code>environment variables</code> of the form "neuprint_*" (see details).</p>
<p>If your server has more than one dataset available, it is also a good idea
  to set the default neuPrint dataset you want to work with, either by
  passing an explicit <code>dataset</code> argument (to <code>neuprint_login</code> or
  <code>neuprint_connection</code>) when first making the connection or by setting
  a <code>neuprint_dataset</code> environment variable.</p>
<p>The connection object returned by <code>neuprint_login</code> (or cached when
  <code>Cache=TRUE</code>, the default) can then be used for future requests to the
  neuPrint server by get/query/fetch functions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">neuprint_connection</span><span class="op">(</span></span>
<span>  server <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  token <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dataset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config <span class="op">=</span> <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/config.html" class="external-link">config</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">neuprint_login</span><span class="op">(</span>conn <span class="op">=</span> <span class="cn">NULL</span>, Cache <span class="op">=</span> <span class="cn">TRUE</span>, Force <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-server">server<a class="anchor" aria-label="anchor" href="#arg-server"></a></dt>
<dd><p>the neuprint server</p></dd>


<dt id="arg-token">token<a class="anchor" aria-label="anchor" href="#arg-token"></a></dt>
<dd><p>your personal Bearer token</p></dd>


<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>A default dataset to use with this connection (you can still
override this using the <code>dataset</code> argument of other <code>neuprintr</code>
functions.)</p></dd>


<dt id="arg-conn">conn<a class="anchor" aria-label="anchor" href="#arg-conn"></a></dt>
<dd><p>a neuprintr connection object</p></dd>


<dt id="arg-config">config<a class="anchor" aria-label="anchor" href="#arg-config"></a></dt>
<dd><p>an <code>httr::<a href="https://httr.r-lib.org/reference/config.html" class="external-link">config</a></code> object that can be used to
set advanced curl options (e.g. additional authentication, proxy settings
etc). See <b>Curl options</b> section and <b>Examples</b>.</p></dd>


<dt id="arg-cache">Cache<a class="anchor" aria-label="anchor" href="#arg-cache"></a></dt>
<dd><p>Whether to cache open connections at login so that they can be
reused automatically.</p></dd>


<dt id="arg-force">Force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>Whether to force a new login to the CATMAID server (default
<code>FALSE</code>)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>methods passed to <code>neuprint_connection</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a <code>neuprint_connection</code> object that can be used to make
  authenticated https requests to a neuPrint server, specifically by making
  use of its <code>$config</code> field.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>After successful login, the <code>neuprint_connection</code> object will
  contain a <code>cookie</code> field that includes a sessionid that is required
  for subsequent GET/POST operations using the package <code>httr</code>. When
  <code>Cache=TRUE</code> (the default) the open connection object is cached and
  will be used when EITHER <code>neuprint_login</code> is called with enough
  information to indicate that the same server is desired OR (when no
  information about the server is passed to <code>neuprint_login</code>) the last
  opened connection will be used. A new connection can be made using
  <code>Force = TRUE</code>, which is advisable as a first call for debugging if
  you are having issues querying the server.</p>
    </div>
    <div id="token-based-authentication">
    <h2>Token based authentication</h2>
    <p>neuPrint requires Bearer token based
  authentication. You can get your token by going to your neuPrint server's
  webpage and right clicking on the icon showing your Google account on the
  top right corner, and selecting <b>AUTH_TOKEN</b>, or often at your
  server's address <code>/token</code>, once you have signed in via your approved
  Google account. Contact the server's administrators if you do not have
  access, but think that you should. You can then set the
  <code>catmaid.token</code> package option, but no</p>
<p>Note that you must <b>NOT</b> reveal this token e.g. by checking it into a
  version controlled script as it gives complete access to your neuPrint
  account.</p>
    </div>
    <div id="environment-variables">
    <h2>Environment variables</h2>



<p>You will very likely want to set the following environment variables in
  your <code>.Renviron</code> file (see <code><a href="https://rdrr.io/r/base/Startup.html" class="external-link">Startup</a></code> for details). This
  file is read by R on startup. In this way the neuprintr package will
  automatically login to your preferred neuPrint server. Note that
  environment variables will also be inherited by child R sessions. This
  means for example that they will be available when running knitr reports,
  tests or R CMD Check from RStudio. In order to edit your R.profile or
  R.environ files easily and directly, try using
  <code>usethis::edit_r_environ()</code> and <code>usethis::edit_r_profile()</code></p>
<p></p><ul><li><p><code>neuprint_server</code></p></li>
<li><p><code>neuprint_token</code></p></li>
<li><p><code>neuprint_dataset</code></p></li>
</ul><p>An example <code>.Renviron</code> file might look like:</p>
<p></p><div class="sourceCode"><pre><code><span><span class="va">neuprint_server</span> <span class="op">=</span> <span class="st">"https://neuprint.janelia.org"</span></span>
<span>  <span class="va">neuprint_token</span> <span class="op">=</span></span>
<span>  <span class="st">"asBatEsiOIJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFsZXhhbmRlci5zaGFrZWVsLmJhdGVzQGdtYWlsLmNvbSIsImxldmVsIjoicmVhZHdyaXRlIiwiaW1hZ2UtdXJsIjoiaHR0cHM7Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1QeFVrTFZtbHdmcy9BQUFBQUFBQUFBDD9BQUFBQUFBQUFBQS9BQ0hpM3JleFZMeEI4Nl9FT1asb0dyMnV0QjJBcFJSZlBRL21vL3Bob3RvLapwZz9zej01MCIsImV4cCI6MTczMjc1MjU2HH0.jhh1nMDBPl5A1HYKcszXM518NZeAhZG9jKy3hzVOWEU"</span></span></code></pre></div>

<p>and <b>must</b> finish with a return at the end of the last line. Your
  <code>neuprint_token</code> is unique to you and must be obtained from a neuPrint
  web page once you have logged in with an approved Google account.</p>
<p>The use of the <code>neuprint_dataset</code> environment variable is optional and
  only recommended when your default neuprint server has more than one
  dataset. This default will <em>not</em> apply to connections that refer to a
  server other than the one specified by the <code>neuprint_server</code>
  environment variable.</p>
<p></p><div class="sourceCode"><pre><code><span><span class="va">neuprint_dataset</span> <span class="op">=</span> <span class="st">"hemibrain:v1.1"</span></span></code></pre></div>

    </div>
    <div id="options">
    <h2>Options</h2>
    <p>Although setting environment variables is the recommended
  approach, you can also set R startup options e.g. in your <code>.Rprofile</code>
  to specify default neuPrint login options including your personal access
  token. The startup options have the same names as the environment variables
  listed above, so you can place code along the lines of:</p>
<p><code>options(neuprint_server = 'https://neuprint.janelia.org',
  neuprint_token =
  "asBatEsiOIJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFsZXhhbmRlci5zaGFrZWVsLmJhdGVzQGdtYWlsLmNvbSIsImxldmVsIjoicmVhZHdyaXRlIiwiaW1hZ2UtdXJsIjoiaHR0cHM7Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1QeFVrTFZtbHdmcy9BQUFBQUFBQUFBDD9BQUFBQUFBQUFBQS9BQ0hpM3JleFZMeEI4Nl9FT1asb0dyMnV0QjJBcFJSZlBRL21vL3Bob3RvLapwZz9zej01MCIsImV4cCI6MTczMjc1MjU2HH0.jhh1nMDBPl5A1HYKcszXM518NZeAhZG9jKy3hzVOWEU")</code></p>
<p>in your <code>.Rprofile</code> (see <code><a href="https://rdrr.io/r/base/Startup.html" class="external-link">Startup</a></code> for details). Note that
  it is important to have a final return at the end of your <code>.Rprofile</code>
  file.</p>
    </div>
    <div id="curl-options">
    <h2>Curl options</h2>
    <p><b>neuprintr</b> uses the curl library provided by the
  <code>httr</code> and <code>curl</code> packages to carry out remote requests. You can
  set curl options by passing an <code>httr::<a href="https://httr.r-lib.org/reference/config.html" class="external-link">config</a></code> object that
  can be used to set advanced curl options (e.g. additional authentication,
  proxy settings etc). See <code><a href="https://jeroen.r-universe.dev/curl/reference/handle.html" class="external-link">handle</a></code> and
  <code><a href="https://jeroen.r-universe.dev/curl/reference/curl_options.html" class="external-link">curl_options</a></code> for a full list of possible options.</p>
<p>You can also set default curl options using environment variables with
  names of the form <code>neuprint_curl_&lt;curloption&gt;</code>. For example the
  following entry in you <code><a href="https://rdrr.io/r/base/Startup.html" class="external-link">Renviron</a></code> file will set the curl
  <code>ssl_verifyhost</code> option:</p>
<p><code>neuprint_curl_ssl_verifyhost=0</code></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></code>, <code><a href="https://rdrr.io/r/base/Startup.html" class="external-link">Startup</a></code>,
  <code><a href="neuprint_info.html">neuprint_datasets</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## example explicitly specifying connection options</span></span></span>
<span class="r-in"><span><span class="va">conn</span> <span class="op">=</span> <span class="fu">neuprint_login</span><span class="op">(</span>server<span class="op">=</span> <span class="st">"neuprint.janelia.org"</span>,</span></span>
<span class="r-in"><span>  token<span class="op">=</span> <span class="st">"asBatEsiOIJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFsZXhhbmRlci5za</span></span></span>
<span class="r-in"><span><span class="st">  GFrZWVsLmJhdGVzQGdtYWlsLmNvbSIsImxldmVsIjoicmVhZHdyaXRlIiwiaW1hZ2UtdXJsIj</span></span></span>
<span class="r-in"><span><span class="st">  oiaHR0cHM7Ly9saDQuZ35vZ2xldXNlcmNvbnRlbnQuY29tLy1QeFVrTFZtbHdmcy9BQUFBQUF</span></span></span>
<span class="r-in"><span><span class="st">  BQUFBDD9BQUFBQUFBQUFBQS9BQ0hpM3JleFZMeEI4Nl9FT1asb0dyMnV0QjJBcFJSZlBRL21v</span></span></span>
<span class="r-in"><span><span class="st">  L3Bob3RvLapwZz9zej01MCIsImV4cCI6MTczMjc1MjM2HH0.jhh1nMDBPl5A1HYKcszXM518NZ</span></span></span>
<span class="r-in"><span><span class="st">  eAhZG9jKy3hzVOWEU"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## examples assuming that neuprint_* environment variables/options are set</span></span></span>
<span class="r-in"><span><span class="va">conn</span> <span class="op">=</span> <span class="fu">neuprint_login</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## using env vars + config to set advanced curl options</span></span></span>
<span class="r-in"><span><span class="fu">neuprint_login</span><span class="op">(</span>config<span class="op">=</span><span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/config.html" class="external-link">config</a></span><span class="op">(</span>ssl_verifyhost<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## now do stuff with the connection like</span></span></span>
<span class="r-in"><span><span class="va">available.datasets</span> <span class="op">=</span> <span class="fu"><a href="neuprint_info.html">neuprint_datasets</a></span><span class="op">(</span>conn<span class="op">=</span><span class="va">conn</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## which, if you have edited your R.profile / R.environ, should produce the same results as</span></span></span>
<span class="r-in"><span><span class="va">available.datasets</span> <span class="op">=</span> <span class="fu"><a href="neuprint_info.html">neuprint_datasets</a></span><span class="op">(</span>conn<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make connection to second server</span></span></span>
<span class="r-in"><span><span class="va">conn2</span><span class="op">=</span><span class="fu">neuprint_login</span><span class="op">(</span>server<span class="op">=</span><span class="st">"https://server2.org"</span>,</span></span>
<span class="r-in"><span>  token<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'NPSERVER2'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify a default dataset (only required when &gt;1 dataset available)</span></span></span>
<span class="r-in"><span><span class="va">conn2</span><span class="op">=</span><span class="fu">neuprint_login</span><span class="op">(</span>server<span class="op">=</span><span class="st">"https://server2.org"</span>,</span></span>
<span class="r-in"><span>  token<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'NPSERVER2'</span><span class="op">)</span>, dataset<span class="op">=</span><span class="st">"hemibrain"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make a connection to the same server but using a different dataset</span></span></span>
<span class="r-in"><span><span class="co"># this may be more convenient than specifying the dataset argument</span></span></span>
<span class="r-in"><span><span class="va">conn3</span><span class="op">=</span><span class="fu">neuprint_login</span><span class="op">(</span><span class="va">conn2</span>, dataset<span class="op">=</span><span class="st">"vnc"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alexander Bates, Gregory Jefferis, Romain Franconville.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

