<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Connect to/authenticate with a neuPrint server and its Neo4j database,
  returning a neuPrint connection object — neuprint_connection • neuprintr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Connect to/authenticate with a neuPrint server and its Neo4j database,
  returning a neuPrint connection object — neuprint_connection" />
<meta property="og:description" content="neuprint_login allows you to login to a neuPrint server
  specified by a neuprint_connection object. If such an object is not
  specified, then the last successful connection in this R session is reused
  if possible otherwise a new connection object is created using
  environment variables of the form &quot;neuprint_*&quot; (see details).
If your server has more than one dataset available, it is also a good idea
  to set the default neuPrint dataset you want to work with, either by
  passing an explicit dataset argument (to neuprint_login or
  neuprint_connection) when first making the connection or by setting
  a neuprint_dataset environment variable.
The connection object returned by neuprint_login (or cached when
  Cache=TRUE, the default) can then be used for future requests to the
  neuPrint server by get/query/fetch functions." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">neuprintr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/customquery.html">Writing query functions in neuprintr</a>
    </li>
    <li>
      <a href="../articles/hemibrain_opns.html">hemibrain olfactory projection neurons</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/natverse/neuprintr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Connect to/authenticate with a neuPrint server and its Neo4j database,
  returning a neuPrint connection object</h1>
    <small class="dont-index">Source: <a href='https://github.com/natverse/neuprintr/blob/master/R/conn.R'><code>R/conn.R</code></a></small>
    <div class="hidden name"><code>neuprint_login.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>neuprint_login</code> allows you to login to a neuPrint server
  specified by a <code>neuprint_connection</code> object. If such an object is not
  specified, then the last successful connection in this R session is reused
  if possible otherwise a new connection object is created using
  <code>environment variables</code> of the form "neuprint_*" (see details).</p>
<p>If your server has more than one dataset available, it is also a good idea
  to set the default neuPrint dataset you want to work with, either by
  passing an explicit <code>dataset</code> argument (to <code>neuprint_login</code> or
  <code>neuprint_connection</code>) when first making the connection or by setting
  a <code>neuprint_dataset</code> environment variable.</p>
<p>The connection object returned by <code>neuprint_login</code> (or cached when
  <code>Cache=TRUE</code>, the default) can then be used for future requests to the
  neuPrint server by get/query/fetch functions.</p>
    </div>

    <pre class="usage"><span class='fu'>neuprint_connection</span><span class='op'>(</span>
  server <span class='op'>=</span> <span class='cn'>NULL</span>,
  token <span class='op'>=</span> <span class='cn'>NULL</span>,
  dataset <span class='op'>=</span> <span class='cn'>NULL</span>,
  conn <span class='op'>=</span> <span class='cn'>NULL</span>,
  config <span class='op'>=</span> <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/config.html'>config</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>neuprint_login</span><span class='op'>(</span>conn <span class='op'>=</span> <span class='cn'>NULL</span>, Cache <span class='op'>=</span> <span class='cn'>TRUE</span>, Force <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>server</th>
      <td><p>the neuprint server</p></td>
    </tr>
    <tr>
      <th>token</th>
      <td><p>your personal Bearer token</p></td>
    </tr>
    <tr>
      <th>dataset</th>
      <td><p>A default dataset to use with this connection (you can still
override this using the <code>dataset</code> argument of other <code>neuprintr</code>
functions.)</p></td>
    </tr>
    <tr>
      <th>conn</th>
      <td><p>a neuprintr connection object</p></td>
    </tr>
    <tr>
      <th>config</th>
      <td><p>an <code>httr::<a href='https://httr.r-lib.org/reference/config.html'>config</a></code> object that can be used to
set advanced curl options (e.g. additional authentication, proxy settings
etc). See <b>Curl options</b> section and <b>Examples</b>.</p></td>
    </tr>
    <tr>
      <th>Cache</th>
      <td><p>Whether to cache open connections at login so that they can be
reused automatically.</p></td>
    </tr>
    <tr>
      <th>Force</th>
      <td><p>Whether to force a new login to the CATMAID server (default
<code>FALSE</code>)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>methods passed to <code>neuprint_connection</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>neuprint_connection</code> object that can be used to make
  authenticated https requests to a neuPrint server, specifically by making
  use of its <code>$config</code> field.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>After successful login, the <code>neuprint_connection</code> object will
  contain a <code>cookie</code> field that includes a sessionid that is required
  for subsequent GET/POST operations using the package <code>httr</code>. When
  <code>Cache=TRUE</code> (the default) the open connection object is cached and
  will be used when EITHER <code>neuprint_login</code> is called with enough
  information to indicate that the same server is desired OR (when no
  information about the server is passed to <code>neuprint_login</code>) the last
  opened connection will be used. A new connection can be made using
  <code>Force = TRUE</code>, which is advisable as a first call for debugging if
  you are having issues querying the server.</p>
    <h2 class="hasAnchor" id="token-based-authentication"><a class="anchor" href="#token-based-authentication"></a>Token based authentication</h2>

    <p>neuPrint requires Bearer token based
  authentication. You can get your token by going to your neuPrint server's
  webpage and right clicking on the icon showing your Google account on the
  top right corner, and selecting <b>AUTH_TOKEN</b>, or often at your
  server's address <code>/token</code>, once you have signed in via your approved
  Google account. Contact the server's administrators if you do not have
  access, but think that you should. You can then set the
  <code>catmaid.token</code> package option, but no</p>
<p>Note that you must <b>NOT</b> reveal this token e.g. by checking it into a
  version controlled script as it gives complete access to your neuPrint
  account.</p>
    <h2 class="hasAnchor" id="environment-variables"><a class="anchor" href="#environment-variables"></a>Environment variables</h2>

    


<p>You will very likely want to set the following environment variables in
  your <code>.Renviron</code> file (see <code><a href='https://rdrr.io/r/base/Startup.html'>Startup</a></code> for details). This
  file is read by R on startup. In this way the neuprintr package will
  automatically login to your preferred neuPrint server. Note that
  environment variables will also be inherited by child R sessions. This
  means for example that they will be available when running knitr reports,
  tests or R CMD Check from RStudio. In order to edit your R.profile or
  R.environ files easily and directly, try using
  <code>usethis::edit_r_environ()</code> and <code>usethis::edit_r_profile()</code></p>
<p></p><ul>
<li><p><code>neuprint_server</code></p></li>
<li><p><code>neuprint_token</code></p></li>
<li><p><code>neuprint_dataset</code></p></li>
</ul><p>An example <code>.Renviron</code> file might look like:</p>
<p></p><pre><span class='va'>neuprint_server</span> <span class='op'>=</span> <span class='st'>"https://neuprint.janelia.org"</span>
  <span class='va'>neuprint_token</span> <span class='op'>=</span>
  <span class='st'>"asBatEsiOIJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFsZXhhbmRlci5zaGFrZWVsLmJhdGVzQGdtYWlsLmNvbSIsImxldmVsIjoicmVhZHdyaXRlIiwiaW1hZ2UtdXJsIjoiaHR0cHM7Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1QeFVrTFZtbHdmcy9BQUFBQUFBQUFBDD9BQUFBQUFBQUFBQS9BQ0hpM3JleFZMeEI4Nl9FT1asb0dyMnV0QjJBcFJSZlBRL21vL3Bob3RvLapwZz9zej01MCIsImV4cCI6MTczMjc1MjU2HH0.jhh1nMDBPl5A1HYKcszXM518NZeAhZG9jKy3hzVOWEU"</span></pre>

<p>and <b>must</b> finish with a return at the end of the last line. Your
  <code>neuprint_token</code> is unique to you and must be obtained from a neuPrint
  web page once you have logged in with an approved Google account.</p>
<p>The use of the <code>neuprint_dataset</code> environment variable is optional and
  only recommended when your default neuprint server has more than one
  dataset. This default will <em>not</em> apply to connections that refer to a
  server other than the one specified by the <code>neuprint_server</code>
  environment variable.</p>
<p></p><pre><span class='va'>neuprint_dataset</span> <span class='op'>=</span> <span class='st'>"hemibrain:v1.0"</span></pre>

    <h2 class="hasAnchor" id="options"><a class="anchor" href="#options"></a>Options</h2>

    <p>Although setting environment variables is the recommended
  approach, you can also set R startup options e.g. in your <code>.Rprofile</code>
  to specify default neuPrint login options including your personal access
  token. The startup options have the same names as the environment variables
  listed above, so you can place code along the lines of:</p>
<p><code><a href='https://rdrr.io/r/base/options.html'>options(neuprint_server = 'https://neuprint.janelia.org',
  neuprint_token =
  "asBatEsiOIJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFsZXhhbmRlci5zaGFrZWVsLmJhdGVzQGdtYWlsLmNvbSIsImxldmVsIjoicmVhZHdyaXRlIiwiaW1hZ2UtdXJsIjoiaHR0cHM7Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1QeFVrTFZtbHdmcy9BQUFBQUFBQUFBDD9BQUFBQUFBQUFBQS9BQ0hpM3JleFZMeEI4Nl9FT1asb0dyMnV0QjJBcFJSZlBRL21vL3Bob3RvLapwZz9zej01MCIsImV4cCI6MTczMjc1MjU2HH0.jhh1nMDBPl5A1HYKcszXM518NZeAhZG9jKy3hzVOWEU")</a></code></p>
<p>in your <code>.Rprofile</code> (see <code><a href='https://rdrr.io/r/base/Startup.html'>Startup</a></code> for details). Note that
  it is important to have a final return at the end of your <code>.Rprofile</code>
  file.</p>
    <h2 class="hasAnchor" id="curl-options"><a class="anchor" href="#curl-options"></a>Curl options</h2>

    <p><b>neuprintr</b> uses the curl library provided by the
  <code>httr</code> and <code>curl</code> packages to carry out remote requests. You can
  set curl options by passing an <code>httr::<a href='https://httr.r-lib.org/reference/config.html'>config</a></code> object that
  can be used to set advanced curl options (e.g. additional authentication,
  proxy settings etc). See <code><a href='https://jeroen.cran.dev/curl/reference/handle.html'>handle</a></code> and
  <code><a href='https://jeroen.cran.dev/curl/reference/curl_options.html'>curl_options</a></code> for a full list of possible options.</p>
<p>You can also set default curl options using environment variables with
  names of the form <code>neuprint_curl_&lt;curloption&gt;</code>. For example the
  following entry in you <code><a href='https://rdrr.io/r/base/Startup.html'>Renviron</a></code> file will set the curl
  <code>ssl_verifyhost</code> option:</p>
<p><code>neuprint_curl_ssl_verifyhost=0</code></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/options.html'>options</a></code>, <code><a href='https://rdrr.io/r/base/Startup.html'>Startup</a></code>,
  <code><a href='neuprint_datasets.html'>neuprint_datasets</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## example explicitly specifying connection options</span>
<span class='va'>conn</span> <span class='op'>=</span> <span class='fu'>neuprint_login</span><span class='op'>(</span>server<span class='op'>=</span> <span class='st'>"neuprint.janelia.org"</span>,
  token<span class='op'>=</span> <span class='st'>"asBatEsiOIJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFsZXhhbmRlci5za
  GFrZWVsLmJhdGVzQGdtYWlsLmNvbSIsImxldmVsIjoicmVhZHdyaXRlIiwiaW1hZ2UtdXJsIj
  oiaHR0cHM7Ly9saDQuZ35vZ2xldXNlcmNvbnRlbnQuY29tLy1QeFVrTFZtbHdmcy9BQUFBQUF
  BQUFBDD9BQUFBQUFBQUFBQS9BQ0hpM3JleFZMeEI4Nl9FT1asb0dyMnV0QjJBcFJSZlBRL21v
  L3Bob3RvLapwZz9zej01MCIsImV4cCI6MTczMjc1MjM2HH0.jhh1nMDBPl5A1HYKcszXM518NZ
  eAhZG9jKy3hzVOWEU"</span><span class='op'>)</span>


<span class='co'>## examples assuming that neuprint_* environment variables/options are set</span>
<span class='va'>conn</span> <span class='op'>=</span> <span class='fu'>neuprint_login</span><span class='op'>(</span><span class='op'>)</span>

<span class='co'>## using env vars + config to set advanced curl options</span>
<span class='fu'>neuprint_login</span><span class='op'>(</span>config<span class='op'>=</span><span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/config.html'>config</a></span><span class='op'>(</span>ssl_verifyhost<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## now do stuff with the connection like</span>
<span class='va'>available.datasets</span> <span class='op'>=</span> <span class='fu'><a href='neuprint_datasets.html'>neuprint_datasets</a></span><span class='op'>(</span>conn<span class='op'>=</span><span class='va'>conn</span><span class='op'>)</span>

<span class='co'>## which, if you have edited your R.profile / R.environ, should produce the same results as</span>
<span class='va'>available.datasets</span> <span class='op'>=</span> <span class='fu'><a href='neuprint_datasets.html'>neuprint_datasets</a></span><span class='op'>(</span>conn<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>

<span class='co'># make connection to second server</span>
<span class='va'>conn2</span><span class='op'>=</span><span class='fu'>neuprint_login</span><span class='op'>(</span>server<span class='op'>=</span><span class='st'>"https://server2.org"</span>,
  token<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>'NPSERVER2'</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># specify a default dataset (only required when &gt;1 dataset available)</span>
<span class='va'>conn2</span><span class='op'>=</span><span class='fu'>neuprint_login</span><span class='op'>(</span>server<span class='op'>=</span><span class='st'>"https://server2.org"</span>,
  token<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>'NPSERVER2'</span><span class='op'>)</span>, dataset<span class='op'>=</span><span class='st'>"hemibrain"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Bates, Gregory Jefferis, Romain Franconville.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


